<%- include("../partials/navbar.ejs") %>

<main class="main my-3 container-fluid">
  <h1 class="h5 text-danger fw-500">ADD CUSTOMER</h1>

  <div class="customerForm newForm">
    <%- include("../partials/messages.ejs") %>
    <form action="/users/new/<%= user._id %>/newCustomer" method="post">
      <div class="my-3">
        <label class="form-label">Picture</label>
        <input required type="file" name="cover" class="filepond" />
      </div>
      <div class="my-3">
        <label class="form-label">First Name</label>
        <input required type="text" class="form-control" name="firstName" />
      </div>
      <div class="my-3s">
        <label class="form-label">Last Name</label>
        <input required type="text" class="form-control" name="lastName" />
      </div>
      <div class="my-3">
        <label class="form-label">Phone</label>
        <input required type="text" class="form-control" name="phone" />
      </div>
      <div class="my-3">
        <label class="form-label">Whatsapp</label>
        <input required type="text" class="form-control" name="whatsapp" />
      </div>
      <div class="my-3">
        <label class="form-label">Company</label>
        <input required type="text" class="form-control" name="company" />
      </div>
      <div class="my-3">
        <label class="form-label">Date of Birth</label>
        <input required type="date" class="form-control" name="dob" />
      </div>
      <div class="my-3">
        <label class="form-label">Gender</label>
        <select name="gender" class="form-control">
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
      <hr />
      <div class="my-3">
        <label class="form-label">License Class</label>
        <select name="lClass" class="form-control">
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
        </select>
      </div>
      <div class="my-3">
        <label class="form-label">License No.</label>
        <input required type="text" class="form-control" name="lNo" />
      </div>
      <div class="my-3">
        <label class="form-label">Reference No.</label>
        <input required type="text" class="form-control" name="refNo" />
      </div>
      <div class="my-3">
        <label class="form-label">Issue Date</label>
        <input
          required
          type="date"
          class="form-control"
          name="issueDate"
          id="issueDate"
        />
      </div>
      <div class="my-3">
        <label class="form-label">Next Renewal</label>
        <input
          required
          type="date"
          class="form-control"
          name="nextRenewal"
          id="nextRenewal"
        />
      </div>
      <div class="my-3">
        <label class="form-label">License Expires on</label>
        <input
          required
          type="date"
          class="form-control"
          name="lExpiry"
          id="lExpiry"
        />
      </div>

      <button type="submit" class="btn btn-secondary">Add Customer</button>
    </form>
  </div>

  <script>

    const issueDateInput = document.getElementById("issueDate");
    const lRenewOneInput = document.getElementById("nextRenewal");
    const lExpiryInput = document.getElementById("lExpiry");

    function addDaysToDate(date, days) {
      const result = new Date(date);
      result.setDate(result.getDate() + days);
      return result;
    }

    issueDateInput.addEventListener("change", function () {
      const issueDate = new Date(issueDateInput.value);
      const lRenewOneDate = addDaysToDate(issueDate, 363);
      const lExpiryDate = addDaysToDate(issueDate, 1826);

      lRenewOneInput.value = lRenewOneDate.toISOString().slice(0, 10);
      lExpiryInput.value = lExpiryDate.toISOString().slice(0, 10);
    });
  </script>
</main>
